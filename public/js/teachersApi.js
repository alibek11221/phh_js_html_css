function ownKeys(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ownKeys(Object(t),!0).forEach(function(a){_defineProperty(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class Vacancy{constructor(e,a,t,n,o,s,r,c,l){_defineProperty(this,"areaName",void 0),_defineProperty(this,"date",void 0),_defineProperty(this,"doljnost",void 0),_defineProperty(this,"typeDoljnost",void 0),_defineProperty(this,"schoolName",void 0),_defineProperty(this,"staj",void 0),_defineProperty(this,"zp",void 0),_defineProperty(this,"dopInfo",void 0),_defineProperty(this,"id",void 0),_defineProperty(this,"isShown",!1),_defineProperty(this,"modalClosing",(e,a)=>{a.removeClass("active"),e.removeClass("active"),$("body").css("overflow","auto"),setTimeout(()=>{e.html("")},450)}),_defineProperty(this,"getDopInfo",()=>this.dopInfo.length?`<p class="mb-0"><b>Доп-ая информация</b>: <span>${this.dopInfo}</span>`:""),_defineProperty(this,"getDoljnost",()=>"1"===this.typeDoljnost?`Учитель ${this.doljnost}`:`${this.doljnost}`),_defineProperty(this,"getZp",()=>"no"===this.zp?"Не указана":this.zp+" &#8381;"),_defineProperty(this,"getMarkUp",()=>`<div class=" bg-white shadow-1" style="width: 360px; border-radius: 3px;">\n                <div class="px-2 py-2"><p class="small font-weight-medium text-uppercase text-muted lts-2px">${this.date}</p>\n                    <h1 class="ff-serif font-weight-normal text-black card-heading my-1" style="line-height: 1.25; font-size: 1.75rem;">\n                    ${this.getDoljnost()}\n                    </h1>\n                    <p class="mb-1"><b>Район</b>: <span>${this.areaName.replace(" МР","")}</span></p>\n                    <p class="mb-1"><b>Школа</b>: <span>${this.schoolName}</span></p>\n                    <p class="mb-1"><b>Зарпалата</b>: <span>${this.getZp()} </span></p>\n                    <p class="mb-1"><b>Стаж работы</b>: <span>${this.staj}</span></p>\n                </div>\n            <a id="${this.id}" class="text-uppercase d-inline-block mb-1 font-weight-medium lts-2px text-center styled-link exit__btn"\n               href="##">Подробнее</a>\n            </div>`),_defineProperty(this,"modalMarkUp",()=>`\n            <a class="close-modal">\n                <svg viewBox="0 0 20 20">\n                    <path d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"\n                          fill="#000000"></path>\n                </svg>\n            </a>\x3c!-- close modal --\x3e\n            <div class="modal-content" style="width: 100%;">\n                <div class="my-2 mx-auto p-relative bg-white"\n                     style="width: 100%; overflow: hidden; border-radius: 1px;">\n                    <div class="px-2 py-2">\n                        <p class="mb-0 small font-weight-medium text-uppercase mb-1 text-muted lts-2px">\n                            ${this.date}</p>\n                        <h1 class="ff-serif font-weight-normal text-black card-heading mt-0 mb-1"\n                            style="line-height: 1.25;">\n                            ${this.getDoljnost()}\n                        </h1>\n                        <p class="mb-1"><b>Район</b>: <span>${this.areaName}</span></p>\n                        <p class="mb-1"><b>Школа</b>: <span>${this.schoolName}</span></p>\n                        <p class="mb-1"><b>Зарпалата</b>: <span>${this.getZp()}</span></p>\n                        <p class="mb-1"><b>Стаж работы</b>: <span>${this.staj}</span></p>\n                        ${this.getDopInfo()}\n                        </p>\n                    </div>\n                    </p>\n                    <p class="mb-1" style="margin: 0; margin-top:7%;">\n                        <a class="text-uppercase d-inline-block font-weight-medium lts-2px ml-2 mb-2 pb-2 text-center styled-link"\n                           href="#0" id="otclick"\n                           style="margin:0;">\n                            Отозваться на вакансию\n                        </a>\n                    </p>\n                </div>\n            </div>\n            <div class="modal_form">\n                <form method="post">\n                    <div class="base-box">\n                        <p class="mb-1 mx-auto"><b>Сопроводительное письмо</b>:</p>\n                        <textarea class="prof-box"\n                                  cols="30"\n                                  id="comment"\n                                  name="comment"\n                                  placeholder="Ваше сопроводительное письмо..."\n                                  rows="10"></textarea>\n                    </div>\n                    <a class="mx-1 text-uppercase d-block font-weight-medium lts-2px text-center styled-link exit__btn"\n                           id="send_vacancy_response"\n                           value="${this.id}">\n                           <i class="icon icon-message"></i>Отправить отзыв\n                    </a>\n                </form>\n            </div>\n            `),_defineProperty(this,"markUpHandlers",(e,a)=>{$("#"+this.id).on("click",t=>{t.preventDefault(),$("body").css("overflow","hidden"),a.addClass("active"),e.html(this.modalMarkUp()).after(()=>{e.addClass("active"),$(".close-modal").on("click",()=>this.modalClosing(e,a)),$("#otclick").on("click",t=>{t.preventDefault(),$(".modal_form").slideToggle(600).after(()=>{$("#send_vacancy_response").on("click",t=>{$(".close-modal").off("click"),t.preventDefault(),$.post({url:`${baseUrl}/vacancy_responses`,data:{vid:this.id,comment:$("#comment").val()}}).fail((t,n)=>{$(".modal_form").hide().after(()=>{$(".modal-content").html(this.badModal("Что-то пошло не так")).after(()=>{this.modalCenter()})}),401===t.status?setTimeout(function(){window.location.href="http://pedagogchr.ru/?openlogin=1"},2e3):setTimeout(()=>this.modalClosing(e,a),1300)}).done((t,n,o)=>{201===o.status?$(".modal_form").hide().after(()=>{$(".modal-content").html(this.okModal("Ваш отзыв на вакансию успешно отправлен")).after(()=>{this.modalCenter()}),setTimeout(()=>this.modalClosing(e,a),1300)}):($(".modal_form").hide().after(()=>{$(".modal-content").html(this.badModal("Что-то пошло не так")).after(()=>{this.modalCenter()})}),setTimeout(()=>this.modalClosing(e,a),1300))})})})})})})}),this.id=l,this.areaName=e.replace(" МР",""),this.date=a,this.doljnost=t,this.typeDoljnost=n,this.schoolName=o,this.staj=s,this.zp=r,this.dopInfo=c,Vacancy.index++}modalCenter(){let e=[$(".modal").height()/2,$(".modal").width()/2],a=[$("#circle").height()/2,$("#circle").width()/2],t=e[0]-a[0],n=e[1]-a[1];$("#circle").css("top",t).css("left",n).css("visibility","visible")}okModal(e){return`<div id="circle" style="position: fixed; visibility: hidden">\n                    <svg class="checkmark" viewBox="0 0 52 52" xmlns="http://www.w3.org/2000/svg">\n                        <circle class="checkmark__circle" cx="26" cy="26" fill="none" r="25"/>\n                        <path class="checkmark__check" d="M14.1 27.2l7.1 7.2 16.7-16.8" fill="none"/>\n                    </svg>\n                    <p class="mb-0 small font-weight-medium text-uppercase mb-1 text-muted lts-2px" style="color: #7ac142;">${e}</p>\n\t            </div>`}badModal(e){return`<div id="circle" style="position: fixed; visibility: hidden">\n                    <svg class="checkmark__x" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n                      <circle class="checkmark__circle__x" cx="26" cy="26" r="25" fill="none" />\n                      <path class="checkmark__check__x" fill="none" d="M16 16 36 36 M36 16 16 36" />\n                    </svg>\n                    <p class="mb-0 small font-weight-medium text-uppercase mb-1 text-muted lts-2px" style="color: #d70707;">${e}</p>\n                </div>`}renderVacancyTeacherSide(e,a,t,n){e.append(this.getMarkUp()),e.hide().appendTo(a).slideDown(500),this.markUpHandlers(t,n),this.isShown=!0}}class VacancyController{constructor(){_defineProperty(this,"vacancyArray",[]),_defineProperty(this,"counter",0),_defineProperty(this,"baseId",`#page_${this.counter}`),_defineProperty(this,"modalBolck",void 0),_defineProperty(this,"modalFon",void 0)}set vacancyArray(e){this.vacancyArray=e}renderVacancies(){"#"+$("#vaca_cards").children().attr("id")!=this.baseId&&$("#vaca_cards").append(`<div class="base-cards my-2 mx-1"  id="page_${this.counter}"></div>`),$("#page_"+this.counter).html(""),this.vacancyArray[this.counter].map(e=>{let a=$("<div class='my-2 p-relative mx-auto'></div>");e.renderVacancyTeacherSide(a,this.baseId,this.modalBolck,this.modalFon)}),this.vacancyArray[this.counter]=[]}}const areaElement=$("#base_areas"),schoolElement=$("#base_schools"),posElement=$("#base_dolj"),payRangeSlider=$("#pay-range"),modal=$("#real_vakansiya_modal"),fon=$("#real_vakansiya_fon"),more=$("#more"),vacancyController=new VacancyController;let areaId=0,schoolId=0,posId=0,paymentValue={min:0,max:0},stajid=0,disable=!1;const localParams=void 0!==localStorage.params?JSON.parse(localStorage.params):{};let params=$.isEmptyObject(localParams)?{dis:disable,ac:areaId,schid:schoolId,pid:posId,pmin:paymentValue.min,pmax:paymentValue.max,staid:stajid,page:vacancyController.counter}:localParams;const CancelToken=axios.CancelToken;let cancel;async function sortVacancies(){cancel&&cancel(),0!==areaId&&(params=_objectSpread(_objectSpread({},params),{},{ac:areaId})),0!==schoolId&&(params=_objectSpread(_objectSpread({},params),{},{schid:schoolId})),0!==posId&&(params=_objectSpread(_objectSpread({},params),{},{pid:posId})),params=_objectSpread(_objectSpread({},params),{},{pmin:paymentValue.min,pmax:paymentValue.max}),0!==stajid&&(params=_objectSpread(_objectSpread({},params),{},{staid:stajid})),vacancyController.counter!==params.page&&(params=_objectSpread(_objectSpread({},params),{},{page:vacancyController.counter})),localStorage.params=JSON.stringify(params);const{data:e}=await axios.get(`${baseUrl}/vacancies/sort`,{cancelToken:new CancelToken(function(e){cancel=e}),params:params});return e}vacancyController.modalBolck=modal,vacancyController.modalFon=fon;let loading=!1;async function renderVacancies(){(loading=!0)&&'<div class="lds-dual-ring"></div>'!==$("#page_"+vacancyController.counter).html()&&$("#page_"+vacancyController.counter).html('<div class="lds-dual-ring"></div>'),vacancyController.vacancyArray[vacancyController.counter]=[],sortVacancies().then(e=>{loading=!1,e.length>=9&&more.fadeIn(500),e.length<9&&more.fadeOut(500),e.length&&(e.map(e=>{vacancyController.vacancyArray[vacancyController.counter].push(new Vacancy(e.areaname,e.date_insert,e.doljnost,e.doljtype,e.schoolname,e.staj,e.zp,e.dop_info,e.id))}),vacancyController.renderVacancies()),e.length||0!==vacancyController.counter||$("#vaca_cards").html('<div class="base-cards my-2 mx-1" id="page_0"><h1 class="text-center" style="flex:1 1 100%">Вакансий не найдено</h1></div>')}).catch(e=>{})}function setSchools(e=0){schoolElement.html('<option selected value="0">Выберите школу</option>'),0==e?getSchools().then(e=>{e.map(e=>{schoolElement.append(`<option value="${e.id}">${e.name.trim()}</option>`)}),schoolElement.val(params.schid),schoolElement.trigger("refresh")}):getSchoolsByArea(e).then(e=>{e.map(e=>{schoolElement.append(`<option value="${e.id}">${e.name.trim()}</option>`)}),schoolElement.val(params.schid),schoolElement.trigger("refresh")})}getDoljnosti().then(e=>{e.map(e=>{posElement.append("1"!==e.typedoljnostid?`<option value="${e.id}">${e.name}</option>`:`<option value="${e.id}">Учитель ${e.name}</option>`)}),posElement.val(params.pid),posElement.trigger("refresh")}),getAreas().then(e=>{e.map(e=>{areaElement.append(`<option value="${e.Code}">${e.name.replace(" МР","")}</option>`)}),"0"!==params.ac&&(areaElement.val(params.ac),setSchools(parseInt(params.ac))),areaElement.trigger("refresh")}),more.on("click",async()=>{vacancyController.counter++,await renderVacancies()}),areaElement.on("change",async e=>{vacancyController.counter=0,vacancyController.vacancyArray=[],areaId=e.target.value,schoolId="0","0000"!==areaId?setSchools(areaId):setSchools(),await renderVacancies()}),payRangeSlider.on("change",async e=>{vacancyController.counter=0,vacancyController.vacancyArray=[];let[a,t]=e.target.value.split(";");paymentValue.min=a,paymentValue.max=t,await renderVacancies()}),payRangeSlider.ionRangeSlider({type:"double",skin:"round",min:3e3,max:1e5,step:100,from:5e3,to:25e3,drag_interval:!0,postfix:" &#8381;"}),schoolElement.on("change",async e=>{vacancyController.counter=0,vacancyController.vacancyArray=[],schoolId=e.target.value,await renderVacancies()}),posElement.on("change",async e=>{vacancyController.counter=0,vacancyController.vacancyArray=[],posId=e.target.value,await renderVacancies()});const payinstance=payRangeSlider.data("ionRangeSlider");$(':radio[name="exp"]').on("change",async e=>{vacancyController.counter=0,vacancyController.vacancyArray=[],stajid=e.target.value,await renderVacancies()}),$("#paymentCheck").on("change",async function(e){vacancyController.counter=0,vacancyController.vacancyArray=[];const a=e.target.checked;params.dis=a,a?(paymentValue.max=0,paymentValue.min=0,await renderVacancies()):payRangeSlider.trigger("change"),payinstance.update({disable:a})}),$(document).ready(()=>{vacancyController.counter=0,vacancyController.vacancyArray=[],$.isEmptyObject(localParams)||(params.pmin>0&&params.pmax>0?payinstance.update({from:params.pmin,to:params.pmax}):$("#paymentCheck").attr("checked",params.dis).trigger("change"),$(`#staj_${params.staid}`).attr("checked",!0)),"0"===params.ac&&setSchools()});